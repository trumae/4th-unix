1 PRINT TAB(33);"H-I-Q"
2 PRINT TAB(15);"CREATIVE COMPUTING  MORRISTOWN, NEW JERSEY"
3 PRINT:PRINT:PRINT
4 REM DIM B(70),T(9,9)
5 PRINT "HERE IS THE BOARD:": PRINT
6 PRINT "          !    !    !"
7 PRINT "         13   14   15": PRINT
8 PRINT "          !    !    !"
9 PRINT "         22   23   24": PRINT
10 PRINT "!    !    !    !    !    !    !"
11 PRINT "29   30   31   32   33   34   35": PRINT
12 PRINT "!    !    !    !    !    !    !"
13 PRINT "38   39   40   41   42   43   44": PRINT
14 PRINT "!    !    !    !    !    !    !"
15 PRINT "47   48   49   50   51   52   53": PRINT
16 PRINT "          !    !    !"
17 PRINT "         58   59   60": PRINT
18 PRINT "          !    !    !"
19 PRINT "         67   68   69": PRINT
20 PRINT "TO SAVE TYPING TIME, A COMPRESSED VERSION OF THE GAME BOARD"
22 PRINT "WILL BE USED DURING PLAY.  REFER TO THE ABOVE ONE FOR PEG"
24 PRINT "NUMBERS.  OK, LET'S BEGIN."
28 REM *** SET UP BOARD
29 R=1
30 C=1
31 IF (R-4)*(R-5)*(R-6)=0 THEN GOTO 40
32 IF (C-4)*(C-5)*(C-6)=0 THEN GOTO 40
35 @(9*R+C)=-5
36 GOTO 50
40 IF (R-1)*(C-1)*(R-9)*(C-9)=0 THEN GOTO 35
42 @(9*R+C)=5
50 IF C<9 THEN C=C+1 : GOTO 31
60 IF R<9 THEN R=R+1 : GOTO 30
65 @(9*5+5)=0: GOSUB 500
70 REM *** INPUT MOVE AND CHECK ON LEGALITY
75 PUSH 13,14,15,22,23,24,29,30,31,32,33,34,35,38,39,40,41
77 PUSH 42,43,44,47,48,49,50,51,52,53,58,59,60,67,68,69
80 FOR W=1 TO 33
83 @(100+POP())=-7
85 NEXT W
86 @(100+41)=-3
100 INPUT "MOVE WHICH PIECE: ";Z
110 IF @(100+Z)=-7 THEN GOTO 140
120 PRINT "ILLEGAL MOVE, TRY AGAIN...": GOTO 100
140 INPUT "TO WHERE? ";P
150 IF @(100+P)=0 THEN GOTO 120
153 IF @(100+P)=-7 THEN GOTO 120
156 IF Z=P THEN GOTO 100
160 IF (Z+P)%2=0 THEN GOTO 180
170 GOTO 120
180 IF (ABS(Z-P)-2)*(ABS(Z-P)-18)#0 THEN GOTO 120
190 GOSUB 1000
200 GOSUB 500
210 GOSUB 1500
220 GOTO 100
500 REM *** PRINT BOARD
510 X=1
520 Y=1
525 IF (X-1)*(X-9)*(Y-1)*(Y-9)=0 THEN GOTO 550
530 IF (X-4)*(X-5)*(X-6)=0 THEN GOTO 570
540 IF (Y-4)*(Y-5)*(Y-6)=0 THEN GOTO 570
550 REM
560 GOTO 610
570 IF @(9*X+Y)#5 THEN GOTO 600
580 PRINT TAB(Y*2);"!";
590 GOTO 610
600 PRINT TAB(Y*2);"O";
610 REM
615 IF Y<9 THEN Y=Y+1 : GOTO 525
620 PRINT
630 IF X<9 THEN X=X+1 : GOTO 520
640 RETURN
1000 REM *** UPDATE BOARD
1005 C=1: X=1
1020 Y=1
1030 IF C#Z THEN GOTO 1220
1040 IF C+2#P THEN GOTO 1080
1045 IF @(9*X+(Y+1))=0 THEN GOTO 120
1050 @(9*X+(Y+2))=5
1060 @(9*X+(Y+1))=0: @(100+C+1)=-3
1070 GOTO 1200
1080 IF C+18#P THEN GOTO 1130
1085 IF @((9*(X+1))+Y)=0 THEN GOTO 120
1090 @((9*(X+2))+Y)=5: @((9*(X+1))+Y)=0: @(100+C+9)=-3
1120 GOTO 1200
1130 IF C-2#P THEN GOTO 1170
1135 IF @(9*X+(Y-1))=0 THEN GOTO 120
1140 @(9*X+(Y-2))=5: @(9*X+(Y-1))=0: @(100+C-1)=-3
1160 GOTO 1200
1170 IF C-18#P THEN GOTO 1220
1175 IF @((9*(X-1))+Y)=0 THEN GOTO 120
1180 @((9*(X-2))+Y)=5: @((9*(X-1))+Y)=0: @(100+C-9)=-3
1200 @(100+Z)=-3: @(100+P)=-7
1210 @(9*X+Y)=0: GOTO 1240
1220 C=C+1
1225 IF Y<9 THEN Y=Y+1 : GOTO 1030
1230 IF X<9 THEN X=X+1 : GOTO 1020
1240 RETURN
1500 REM*** CHECK IF GAME IS OVER
1505 F=0
1510 R=2
1520 C=2
1530 IF @(9*R+C)#5 THEN GOTO 1580
1535 F=F+1
1540 A=R-1
1545 T=0
1550 FOR B=C-1 TO C+1 : T=T+@(9*A+B) : NEXT B
1564 IF T#10 THEN GOTO 1567
1565 IF @(9*A+C)#0 THEN RETURN
1567 IF A<R+1 THEN A=A+1 : GOTO 1545
1568 X=C-1
1569 T=0
1570 FOR Y=R-1 TO R+1 : T=T+@(9*Y+X) : NEXT Y
1573 IF T#10 THEN GOTO 1575
1574 IF @(9*R+X)#0 THEN RETURN
1575 IF X<C+1 THEN X=X+1 : GOTO 1569
1580 IF C<8 THEN C=C+1 : GOTO 1530
1590 IF R<8 THEN R=R+1 : GOTO 1520
1600 REM *** GAME IS OVER
1605 PRINT "THE GAME IS OVER."
1610 PRINT "YOU HAD ";F;" PIECES REMAINING."
1611 IF F#1 THEN GOTO 2000
1612 PRINT "BRAVO!  YOU MADE A PERFECT SCORE!"
1613 PRINT "SAVE THIS PAPER AS A RECORD OF YOUR ACCOMPLISHMENT!"
2000 PRINT: PRINT "SO LONG FOR NOW.": PRINT
2010 END
